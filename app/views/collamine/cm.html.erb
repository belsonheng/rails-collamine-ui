<% content_for :head do %> 

	<meta name="viewport" content="width=device-width, initial-scale=1">

	
	<!-- start: CSS -->
	<link id="bootstrap-style" href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/bootstrap-responsive.min.css" rel="stylesheet">
	<link id="base-style" href="css/style.css" rel="stylesheet">
	<link id="base-style-responsive" href="css/style-responsive.css" rel="stylesheet">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&subset=latin,cyrillic-ext,latin-ext' rel='stylesheet' type='text/css'>
	<!-- end: CSS -->	

        <link rel="stylesheet" href="//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css">
        <link rel="stylesheet" href="//resources/demos/style.css">

        <style>
        label {
          display: inline-block;
          width: 5em;
        }
        </style>

<% end %>

	
	<div class="container-fluid-full">
			
			<div id="box" class="span10">
				<div class="row-fluid">
					<div class="span3 statbox" onTablet="span6" onDesktop="span3"  style= "background: #C7AFBD; color:white; width: 340px;">
						<div class="boxchart">5,6,7,2,0,4,2,4,8,2,3,3,2</div>
						<div id="totalupload" title="Displays the count of number of uploads into CollaMine server by client if document is not found in server" class="number"><%= @uploads %><i class="icon-arrow-up"></i></div>
						<div class="title">Uploads</div>
							
					</div>
				<div class="span3 statbox" onTablet="span6" onDesktop="span3"  style= "background:#DDECEF; color:grey; width: 340px;">
					<div class="boxchart">1,2,6,4,0,8,2,4,5,3,1,7,5</div>
					<div id="totaldownload" title="Displays the count of number of downloads from CollaMine server by client if document is found in server" class="number"><%= @downloads %><i class="icon-arrow-down"></i></div>
					<div class="title">Downloads</div>
					
				</div>
				<div class="span3 statbox noMargin" onTablet="span6" onDesktop="span3"  style= "background: #C0C0C0; color:white; width: 340px;">
					<div class="boxchart">5,6,7,2,0,-4,-2,4,8,2,3,3,2</div>
					<div id="total" title="Displays the total number of uploads and downloads by this specific client" class="number" style="margin-top:7px"><%= @total %></div>
					<div class="title">Documents</div>
					
				</div>
	                        <div class="span3 statbox noMargin" onTablet="span6" onDesktop="span3"  style= "background: #F8F2DA; color:grey; width: 340px;">
					<div class="boxchart">2,6,7,2,0,6,2,4,8,2,3,3,8</div>
					<div id="disk" class="number" style="margin-top:7px"><%= @disk %>GB</div>
					<div class="title">
					<div>Disk Used</div>
					
				</div>
	
				</div>	
			</div>

		
			
				<div class="row-fluid">
					
					<div class="span8 widget" onTablet="span7" onDesktop="span8" style= "background:#DDECEF; color:black; width:945px;">
						<div style="width:90%; ">
						<div style="margin-right:-50px">
					<img src="/img/orange.jpg" style="width:14px;height: 14px" align="right"> <p align="right">CollaMine :</p>
					<img src="/img/blue.jpg" style="width:14px;height: 14px" align="right"><p align="right">Original :</p>
					<div id="lineChart" class="epoch" style="width: 100%; height: 295px;"></div>
						</div>
						</div>
						
					</div>
					
					<div class="sparkLineStats span4 widget" onTablet="span5" onDesktop="span4" style="height: 375px; background:#C7AFBD; color:black; width: 490px;">

						<div id="container">
							<img src="/img/purple.png" style="width:14px;height: 14px" align="right"><p align="right">CollaMine: </p>
							<img src="/img/purple.jpg" style="width:14px;height: 14px" align="right"><p align="right">Original: </p>
							<div id="pie" class="epoch category20b" style="width: 285px; height: 300px; margin-left:85px; margin-top:-35px"></div>
							</div>

						<div class="clearfix"></div>
						</div>
						</div>
						
				<div class="row-fluid">
					
					<div class="widget span5" onTablet="span6" onDesktop="span5" style="height: 380px; background: #F8F2DA; color:black; width: -400px;">
						
						<h2><span class="glyphicons globe"><i></i></span> RECENTLY VISITED DOCUMENTS:</h2>
						<hr>
						<div class="content">
						<div id="url" style="height:275px;width:555px;border:1px solid #ccc;font:16px/26px Georgia, Garamond, Serif;overflow:auto;">
						<ul>
           					 <% @url.each { |x| %> 
							<li><p><%= link_to x.split('/')[-1], {:controller => "collamine", :action => "download", :url => x }%></p></li>
							<% } %></ul>
						</div>
						
						</div>
						
					</div>
					
					<div class="widget span3" onTablet="span6" onDesktop="span3" style="width: 410px; height: 380px; background:#C0C0C0; color: black;">
						<h2><span class="glyphicons fire"><i></i></span> RECENT 10 DOMAINS USED:</h2>
						<hr>
						<div id="domain" class="content">
							<ol><% @domain.each { |x| %> 
							<li><p><%= x %></p></li>
							<% } %></ol>
						</div>
					</div>
					
					<div class="box span4" onTablet="span6" onDesktop="span4" style="width: 385px; height: 380px; background:#DDECEF;">
						<div class="box-header" style="background:grey;">
							<h2><i class="halflings-icon white user" ></i><span class="break" ></span>Suggested Domains</h2>
							<div class="box-icon">
							<a href="#" class="btn-minimize" ><i class="halflings-icon white chevron-up"></i></a>
							</div>
						</div>
						<div class="box-content" style="background:#C0C0C0;">
							<ul class="dashboard-list metro">
								<li style="background:#C7AFBD; color:black;">
									<a href="#">
										<img class="avatar" alt="Dennis Ji" src="/img/HW.jpg">
									</a>
									<br>
									<a href="http://forums.hardwarezone.com.sg/" target="_blank"><strong>HardwareZone</strong></a><br>
									<br>             
								</li>
								<li style="background:#DDECEF; color:black;">
									<a href="#">
										<img class="avatar" alt="Dennis Ji" src="/img/VR.png">
									</a>
									<br>
									<a href="http://forums.vr-zone.com/" target="_blank"><strong>Vr-Zone</strong></a><br>
									<br>                             
								</li>
								<li style="background:#C0C0C0; color:black;">
									<a href="#">
										<img class="avatar" alt="Dennis Ji" src="/img/SG.gif">
									</a>
									<br>
									<a href="http://sgforums.com/" target="_blank"><strong>Sg Forums</strong></a><br>
									<br>                                
								</li>
								<li style="background:#F8F2DA; color:black;">
									<a href="#">
										<img class="avatar" alt="Dennis Ji" src="/img/CN.jpeg">
									</a>
									<br>
									<a href="http://forums.cnet.com/" target="_blank"><strong>Cnet Forum</strong></a><br>
									<br>                            
								</li>
							</ul>
						</div>
					</div>
				</div>
				
				<div class="row-fluid">
				
	<div class="modal hide fade" id="myModal">
		<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal">×</button>
		<h3>Settings</h3>
		</div>
		<div class="modal-body">
		<p>Here settings can be configured...</p>
		</div>
		<div class="modal-footer">
		<a href="#" class="btn" data-dismiss="modal">Close</a>
		<a href="#" class="btn btn-primary">Save changes</a>
		</div>
	</div>
	
	<div class="common-modal modal fade" id="common-Modal1" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-content">
			<ul class="list-inline item-details">
			<li><a href="http://themifycloud.com">Admin templates</a></li>
			<li><a href="http://themescloud.org">Bootstrap themes</a></li>
			</ul>
		</div>
	</div>
	<div class="row-fluid">
	
		<div class="span3 statbox" onTablet="span6" onDesktop="span3"  style= "background:#DDECEF; color:grey; width: 340px;">
						<div class="boxchart">5,6,7,2,0,4,2,4,8,2,3,3,2</div>
						<div id="memory" class="number"><%= @memory %>%</div>
						<div class="title">Active Memory Used</div>
							
					</div>
				<div class="span3 statbox noMargin" onTablet="span6" onDesktop="span3"  style= "background: #C0C0C0; color:white; width: 340px;">
					<div class="boxchart">1,2,6,4,0,8,2,4,5,3,1,7,5</div>
					<div id="cpu" class="number"><%= @cpu %>%</div>
					<div class="title">CPU Used</div>
					
				</div>
				
					<div class="span3 statbox noMargin" onTablet="span6" onDesktop="span3"  style= "background: #F8F2DA; color:grey; width: 340px;">
					<div class="boxchart">5,6,7,2,0,-4,-2,4,8,2,3,3,2</div>
					<div id="reads" class="number" style="margin-top:7px"><%= @reads %>/s</div>
					<div class="title">Current Disk Reads Completed</div>
					
				</div>
	
		<div class="span3 statbox" onTablet="span6" onDesktop="span3"  style= "background: #C7AFBD; color:white; width: 340px;">
					<div class="boxchart">2,6,7,2,0,6,2,4,8,2,3,3,8</div>
					<div id="writes" class="number" style="margin-top:7px"><%= @writes %>/s</div>
					<div class="title">
					<div>Current Disk Writes Completed</div>
					
				</div>
	
				</div>	
			</div>
	<div class="clearfix"></div>
	
	<!-- start: JavaScript-->
                <script src="//code.jquery.com/ui/1.11.3/jquery-ui.js"></script>
		<script src="js/jquery-1.9.1.min.js"></script>
		<script src="js/jquery-migrate-1.0.0.min.js"></script>
		<script src="js/jquery-ui-1.10.0.custom.min.js"></script>
		<script src="js/jquery.ui.touch-punch.js"></script>
		<script src="js/modernizr.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/jquery.cookie.js"></script>
		<script src='js/fullcalendar.min.js'></script>
		<script src='js/jquery.dataTables.min.js'></script>
		<script src="js/excanvas.js"></script>
		<script src="js/jquery.flot.js"></script>
		<script src="js/jquery.flot.pie.js"></script>
		<script src="js/jquery.flot.stack.js"></script>
		<script src="js/jquery.flot.resize.min.js"></script>
		<script src="js/jquery.chosen.min.js"></script>
		<script src="js/jquery.uniform.min.js"></script>
		<script src="js/jquery.cleditor.min.js"></script>
		<script src="js/jquery.noty.js"></script>
		<script src="js/jquery.elfinder.min.js"></script>
		<script src="js/jquery.raty.min.js"></script>
		<script src="js/jquery.iphone.toggle.js"></script>
		<script src="js/jquery.uploadify-3.1.min.js"></script>
		<script src="js/jquery.gritter.min.js"></script>
		<script src="js/jquery.imagesloaded.js"></script>
		<script src="js/jquery.masonry.min.js"></script>
		<script src="js/jquery.knob.modified.js"></script>
		<script src="js/jquery.sparkline.min.js"></script>
		<script src="js/counter.js"></script>
		<script src="js/retina.js"></script>
		<script src="js/custom.js"></script>
	<!-- end: JavaScript-->

<script>

  $(document).ready(function() {
    $(document).tooltip();
  });

  $(function(){

// Declaring variable, assigning value from the retrieved data from controller and converting it to json: 
  	var pieData = <%= raw @pie_chart_data.to_json %>;

// For reference to use later in ajax when updating data
  	var chart = $('#lineChart')
			    .epoch({
			        type: 'time.line',
			        data: <%= raw @line_chart_data.to_json %>,
			        axes: ['bottom']
			    });

// For reference to use later in ajax when updating data
	var pie = $('#pie')
			  .epoch({
			    type: 'pie',
			    data: pieData
			  });

// Defining a new function argument:
	function updatePie(){

// Getting the json object from the path and store in data variable
		$.getJSON('/collamine/pie', function (data) {

// Checking if the data is empty
		    if (data) {

// After checking if data is not empty, then proceed with updating the pie chart
				pie.update(data);
		    }
		});
	}

// Defining a new function argument:
	function updateLine() {

// In the HTML div id=total, return all the text that resides within the div#total
	  var total = $("div#total").text();

// Getting the json object from the path and store in data variable
	  $.getJSON('/collamine/line?total='+total, function (data) {

// Checking if the data is empty
		    if (data) {

// After checking if data is not empty then proceed with updating the line chart
				chart.push(data);
		    }
		});
	}

// Defining a new function argument:
	function updateTotal() {

//  Getting the json object from the path and store in ajax variable
		$.getJSON('/collamine/ajax', function (ajax) {

// Checking if the data is empty
			if (ajax) {

// In the HTML div id=total, set the content of each element in the div#total tag to the specified text (Overwrites)
				$( "div#total" ).text(function() {

// Getting the value stored in the total field of the json object
  					return ajax.total;
				});

// In the HTML div id=totalupload, get the HTML contents of the first element in the div#totalupload tag
				$( "div#totalupload" ).html(function() {

// Getting the value stored in the upload field of the json object
  					return ajax.uploads + "<i class='icon-arrow-up'></i>";
				});

// In the HTML div id=totalupload, get the HTML contents of the first element in the div#totaldownload tag
				$( "div#totaldownload" ).html(function() {

// Getting the value stored in the download field of the json object
  					return ajax.downloads + "<i class='icon-arrow-down'></i>";
				});

// If the div of the above HTML id=url,
				$( "div#url" ).html(function() {

// Set url to empty,
					var urls = "";

// Looping through the data of urls:
					$.each(ajax.urls, function(index, value) {

// Extracts parts of a string, then returns the position of the last occurrence of the value in a string after the slash / 
						var filename = value.substring(value.lastIndexOf('/')+1);

//Checking if the filename is empty
						if (filename == "") { 

// Removing the last character of the string
							var temp = value.substring(0, value.length-1);

// Extracting the last part of string after the last slash to use as filename
							filename = temp.substring(temp.lastIndexOf('/')+1);
						}

// Appending the right side to var urls

						urls += "<li><p><a href='/collamine/download?url=" + value + "'>" + filename + "</a></p></li>";
					});

// Display the urls in unordered list
  					return "<ul>" + urls + "</ul>";
				});

// If the div id of the HTML above = domain, 
				$( "div#domain" ).html(function() {

// Set domain to empty,
  					var domains = "";

// Looping through the data of domains:
					$.each(ajax.domains, function(index, value) {

// Appending the right side to var domains
						domains += "<li><p>" + value + "</p></li>";
					});

// Display the domains in ordered list
  					return "<ol>" + domains + "</ol>";
				});
			}
		});
	}

// Defining a new function argument:
	function updateWatch() {

//  Getting the json object from the path and store in watch variable
		$.getJSON('/collamine/watch', function (watch) {

// Checking if the data is empty
			if (watch) {
// Ajax for usagewatch
				$( "div#disk" ).html(function() {
  					return watch.disk + "GB";
				});
				$( "div#memory" ).html(function() {
  					return watch.memory + "%";
				});
				$( "div#cpu" ).html(function() {
  					return watch.cpu + "%";
				});
				$( "div#reads" ).html(function() {
  					return watch.reads + "/s";
				});
				$( "div#writes" ).html(function() {
  					return watch.writes + "/s";
				});
			}
		});
	}

// Execute to update after every 1 second when setInterval method invokes (calls) the function:
	setInterval(updateLine, 1000);
	setInterval(updateTotal, 1000);
	setInterval(updatePie, 1000);
// Execute to update after every 1 min when setInterval method invokes (calls) the function:
	setInterval(updateWatch, 60000);
  });



</script>
